<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Checkout - TechStore</title>
    <meta
      name="description"
      content="Complete your order at TechStore. Secure checkout with multiple payment options."
    />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/checkout.css" />
    <link rel="stylesheet" href="../css/mobile-nav.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <nav class="nav">
        <div class="nav-container">
          <div class="nav-brand">
            <a href="../index.html" class="brand-name-link"
              ><h1 class="brand-name">TechStore</h1></a
            >
          </div>
          <button
            class="nav-toggle"
            aria-label="Open navigation"
            aria-expanded="false"
          >
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
          </button>
          <div class="nav-menu" id="navMenu">
            <a href="../index.html" class="nav-link">Home</a>
            <a href="store.html" class="nav-link">Store</a>
            <a href="contact.html" class="nav-link">Contact</a>
            <a href="checkout.html" class="nav-link cart-link">
              Cart <span class="cart-count" id="cartCount">0</span>
            </a>
          </div>
        </div>
      </nav>
    </header>

    <!-- Main Content -->
    <main>
      <div class="container">
        <div class="checkout-layout">
          <!-- Order Form -->
          <div class="order-form-section">
            <h1 class="page-title">Complete Your Order</h1>

            <form id="orderForm" class="order-form">
              <!-- Customer Information -->
              <div class="form-section">
                <h2>Customer Information</h2>
                <div class="form-row">
                  <div class="form-group">
                    <label for="firstName">First Name *</label>
                    <input
                      type="text"
                      id="firstName"
                      name="firstName"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <label for="lastName">Last Name *</label>
                    <input type="text" id="lastName" name="lastName" required />
                  </div>
                </div>
                <div class="form-group">
                  <label for="email">Email Address *</label>
                  <input type="email" id="email" name="email" required />
                </div>
                <div class="form-group">
                  <label for="phone">Phone Number *</label>
                  <input type="tel" id="phone" name="phone" required />
                </div>
                <div class="form-group">
                  <label for="city">City *</label>
                  <input type="text" id="city" name="city" required />
                </div>
                <div class="form-group">
                  <label for="state">State/Province *</label>
                  <input type="text" id="state" name="state" required />
                </div>
              </div>

              <!-- Submit Button -->
              <div class="form-section">
                <button
                  type="submit"
                  class="btn btn-primary btn-large"
                  id="submitOrder"
                >
                  Place Order
                </button>
              </div>
            </form>
          </div>

          <!-- Order Summary -->
          <div class="order-summary-section">
            <div class="order-summary">
              <h2>Order Summary</h2>

              <div class="cart-items" id="cartItems">
                <!-- Cart items will be loaded dynamically -->
              </div>

              <div class="order-totals">
                <div class="total-row total">
                  <span>Total:</span>
                  <span id="total">‚Ç¶0.00</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Thank You Modal -->
    <div id="thankYouModal" class="modal-overlay" style="display:none;">
      <div class="thank-you-modal-card">
        <div class="success-icon">‚úÖ</div>
        <h1 class="thank-you-title">Thank You for Your Order!</h1>
        <p class="thank-you-subtitle">
          Your order has been successfully received and is being processed. <br>
          We will contact you, soon!
        </p>
        <div class="contact-support">
          <h2>Need Help?</h2>
          <div class="support-options">
            <a href="contact.html" class="btn btn-primary">Contact Support</a>
          </div>
        </div>
        <div class="continue-shopping">
          <h2>Continue Shopping</h2>
          <a href="store.html" class="btn btn-primary">Browse Products</a>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div
      id="loadingOverlay"
      class="modal-overlay"
      style="display:none;align-items:center;justify-content:center;"
    >
      <div class="loading-spinner"></div>
      <span class="loading-text">Processing your order...</span>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3 class="brand-name">TechStore</h3>
            <p id="footerStoreDesc">
              Your trusted partner for premium electronics and exceptional
              service.
            </p>
          </div>
          <div class="footer-section">
            <h4>Quick Links</h4>
            <ul>
              <li><a href="../index.html">Home</a></li>
              <li><a href="store.html">Store</a></li>
              <li><a href="contact.html">Contact</a></li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Contact Info</h4>
            <p id="footerEmail">üìß info@techstore.com</p>
            <p id="footerPhone">üì± +1 (555) 123-4567</p>
            <p id="footerAddress">üìç 123 Tech Street, Digital City</p>
          </div>
        </div>
        <div class="footer-bottom">
          <p>
            &copy; <span id="time">2024</span> TechStore. All rights reserved.
          </p>
        </div>
      </div>
    </footer>

    <!-- Scripts -->
    <script>
      var time = document.getElementById("time");
      time.innerHTML = new Date().getFullYear();
    </script>
    <script src="../scripts/branding.js"></script>
    <script src="../scripts/cart.js"></script>
    <script src="../scripts/filtering.js"></script>
    <script src="../scripts/emailjs-config.js"></script>
    <script src="../scripts/mobile-nav.js"></script>
    <script>
      // Modal and loading logic via callbacks from cart.js
      const thankYouModal = document.getElementById("thankYouModal");
      const loadingOverlay = document.getElementById("loadingOverlay");
      window.checkoutCallbacks = {
        onStart() {
          if (loadingOverlay) loadingOverlay.style.display = "flex";
        },
        onSuccess() {
          if (loadingOverlay) loadingOverlay.style.display = "none";
          if (thankYouModal) thankYouModal.style.display = "flex";
        },
        onError() {
          if (loadingOverlay) loadingOverlay.style.display = "none";
        },
        onFinally() {
          // no-op for now, reserved for future usage
        }
      };
      // Close modal on click outside
      thankYouModal.addEventListener("click", function (e) {
        if (e.target === thankYouModal) thankYouModal.style.display = "none";
      });
    </script>
  </body>
</html>
